æˆ‘æ¥è¯¦ç»†è®²è§£**æ–¹æ¡ˆ3çš„æ ¸å¿ƒè°ƒåº¦æœºåˆ¶**ï¼šPlanç”Ÿæˆåå¦‚ä½•åœ¨ReAct Loopä¸­æ‰§è¡Œã€è°ƒåº¦å’ŒåŠ¨æ€è°ƒæ•´ã€‚

---

## ğŸ¯ æ ¸å¿ƒæ€æƒ³

> **Plan = "åœ°å›¾"ï¼ˆåšä»€ä¹ˆ + é¡ºåºï¼‰**  
> **ReAct Loop = "æ™ºèƒ½å¸æœº"ï¼ˆæ€ä¹ˆæ‰§è¡Œ + åŠ¨æ€è°ƒæ•´ï¼‰**  
> **å…¨ç¨‹åªæœ‰ä¸€ä¸ªReAct Loop**ï¼ŒPlanåªæ˜¯ä½œä¸º**ä¸Šä¸‹æ–‡æç¤º**æ³¨å…¥å…¶ä¸­

---

## ğŸ“Š æ•´ä½“æ¶æ„ä¸æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·è¾“å…¥                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å¤æ‚åº¦åˆ¤æ–­å±‚    â”‚
                    â”‚  (å‰ç½®+åç½®)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                 â”‚
       ç®€å•ä»»åŠ¡                          å¤æ‚ä»»åŠ¡
            â”‚                                 â”‚
            â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                    â”‚   Planæ¨¡å—               â”‚
            â”‚                    â”‚   - ç”Ÿæˆåˆå§‹è®¡åˆ’         â”‚
            â”‚                    â”‚   - æ ¼å¼ï¼šJSON/æ–‡æœ¬      â”‚
            â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                 â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ReAct Loop     â”‚ â†â”€ ç»Ÿä¸€æ‰§è¡Œå¼•æ“
                    â”‚  (å”¯ä¸€å…¥å£)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Thought â”‚        â”‚ Action  â”‚        â”‚Observe  â”‚
    â”‚(æ¨ç†)   â”‚ â”€â”€â”€â”€â”€â”€â–ºâ”‚(è¡ŒåŠ¨)   â”‚ â”€â”€â”€â”€â”€â”€â–ºâ”‚(è§‚å¯Ÿ)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â–²                                      â”‚
         â”‚                                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    åæ€ & è°ƒæ•´è®¡åˆ’
```

---

## ğŸ”§ è¯¦ç»†æ‰§è¡Œæµç¨‹ï¼ˆåˆ†æ­¥æ‹†è§£ï¼‰

### **ç¬¬1æ­¥ï¼šPlanç”Ÿæˆä¸æ³¨å…¥**

```python
class Agent:
    def __init__(self):
        self.plan = None           # å­˜å‚¨å½“å‰è®¡åˆ’
        self.completed_steps = []  # å·²å®Œæˆæ­¥éª¤
        self.current_step = None   # å½“å‰æ‰§è¡Œæ­¥éª¤
        self.react_loop = ReactLoop()  # ç»Ÿä¸€æ‰§è¡Œå¼•æ“
    
    def handle_query(self, user_query):
        # 1. å¤æ‚åº¦åˆ¤æ–­
        if self.is_complex_task(user_query):
            # 2. ç”ŸæˆPlanï¼ˆJSONæ ¼å¼ï¼‰
            self.plan = self.planner.generate_plan(user_query)
            """
            self.plan = {
                "steps": [
                    {"id": "step_1", "name": "æœç´¢APIæ–‡æ¡£", "tool": "search_tool"},
                    {"id": "step_2", "name": "ç”Ÿæˆä»£ç ", "tool": "code_tool"},
                    {"id": "step_3", "name": "è¿è¡Œæµ‹è¯•", "tool": "test_tool"}
                ]
            }
            """
        else:
            self.plan = None  # ç®€å•ä»»åŠ¡æ— è®¡åˆ’
        
        # 3. ç»Ÿä¸€å…¥å£ï¼šReAct Loop
        return self.react_loop.execute(user_query, plan=self.plan)
```

---

### **ç¬¬2æ­¥ï¼šReAct Loopæ‰§è¡Œï¼ˆæ ¸å¿ƒè°ƒåº¦é€»è¾‘ï¼‰**

```python
class ReactLoop:
    def execute(self, query, plan=None):
        self.context = {
            "user_query": query,
            "plan": plan,
            "completed_steps": [],
            "current_step": None,
            "history": []  # å®Œæ•´å¯¹è¯å†å²
        }
        
        max_iterations = 15
        iteration = 0
        
        while iteration < max_iterations:
            iteration += 1
            
            # ========== 1. THOUGHTï¼ˆæ¨ç†ï¼‰==========
            thought = self.generate_thought(self.context)
            self.context["history"].append({"role": "thought", "content": thought})
            
            # ========== 2. ACTIONï¼ˆè¡ŒåŠ¨ï¼‰==========
            action = self.decide_action(thought, self.context)
            self.context["history"].append({"role": "action", "content": action})
            
            # ========== 3. OBSERVEï¼ˆè§‚å¯Ÿï¼‰==========
            observation = self.execute_action(action)
            self.context["history"].append({"role": "observation", "content": observation})
            
            # ========== 4. ç›‘æ§ä¸è°ƒæ•´ ==========
            if self.should_adjust_plan(observation, self.context):
                self.adjust_plan(self.context)
            
            # ========== 5. åˆ¤æ–­æ˜¯å¦å®Œæˆ ==========
            if self.is_task_complete(observation, self.context):
                break
        
        return self.generate_final_answer(self.context)
```

---

### **ç¬¬3æ­¥ï¼šTHOUGHTé˜¶æ®µï¼ˆå¦‚ä½•è¯»å–å’Œç†è§£Planï¼‰**

```python
def generate_thought(self, context):
    """
    æ ¸å¿ƒï¼šå°†Planä¿¡æ¯æ³¨å…¥åˆ°æ¨ç†æç¤ºä¸­
    """
    
    plan_info = ""
    if context["plan"]:
        # æ ¼å¼åŒ–å½“å‰è®¡åˆ’çŠ¶æ€
        steps = context["plan"]["steps"]
        completed = context["completed_steps"]
        
        plan_info = f"""
ã€å½“å‰è®¡åˆ’ã€‘
æ€»æ­¥éª¤æ•°ï¼š{len(steps)}
å·²å®Œæˆï¼š{len(completed)}/{len(steps)}

æ­¥éª¤è¯¦æƒ…ï¼š
"""
        for step in steps:
            status = "âœ… å·²å®Œæˆ" if step["id"] in completed else "â³ å¾…æ‰§è¡Œ"
            if step["id"] not in completed and not context["current_step"]:
                status = "ğŸ¯ æ­£åœ¨æ‰§è¡Œ"  # æ ‡è®°ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„æ­¥éª¤
                context["current_step"] = step["id"]
            
            plan_info += f"- {step['name']} ({step['id']}) [{status}]\n"
    
    # æ„é€ å®Œæ•´çš„Thoughtæç¤º
    thought_prompt = f"""
ã€ç”¨æˆ·éœ€æ±‚ã€‘
{context['user_query']}

{plan_info}

ã€æ‰§è¡Œå†å²ã€‘
{self.format_history(context['history'][-5:])}  # æœ€è¿‘5è½®

ã€å½“å‰çŠ¶æ€ã€‘
- ä¸Šä¸€æ­¥è§‚å¯Ÿï¼š{context['history'][-1]['content'] if context['history'] else 'æ— '}

ã€è¯·æ€è€ƒã€‘
1. å½“å‰åº”è¯¥æ‰§è¡Œå“ªä¸ªæ­¥éª¤ï¼Ÿ
2. æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·ï¼Ÿè°ƒç”¨å“ªä¸ªå·¥å…·ï¼Ÿ
3. æ˜¯å¦å‘ç°è®¡åˆ’æœ‰é—®é¢˜ï¼Ÿæ˜¯å¦éœ€è¦è°ƒæ•´è®¡åˆ’ï¼Ÿ
4. å¦‚ä½•åˆ©ç”¨å·²æ‰§è¡Œæ­¥éª¤çš„ç»“æœï¼Ÿ

ã€è¾“å‡ºæ ¼å¼ã€‘
THOUGHT: [ä½ çš„æ¨ç†]
"""
    
    # è°ƒç”¨LLMç”ŸæˆThought
    thought = self.llm.generate(thought_prompt)
    return thought
```

**ğŸ’¡ å…³é”®ç‚¹**ï¼š
- Planä¿¡æ¯ä½œä¸º**ä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†**æ³¨å…¥åˆ°æ¯æ¬¡Thoughtä¸­
- LLMèƒ½çœ‹åˆ°**å®Œæ•´è®¡åˆ’ + å·²å®Œæˆæ­¥éª¤ + å½“å‰çŠ¶æ€**
- LLMè‡ªä¸»å†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼ˆè€Œéæœºæ¢°æ‰§è¡Œï¼‰

---

### **ç¬¬4æ­¥ï¼šACTIONé˜¶æ®µï¼ˆå¦‚ä½•æ‰§è¡Œè®¡åˆ’ä¸­çš„æ­¥éª¤ï¼‰**

```python
def decide_action(self, thought, context):
    """
    æ ¹æ®Thoughtå†³å®šå…·ä½“è¡ŒåŠ¨
    """
    
    # è§£æLLMçš„Thoughtï¼Œæå–è¡ŒåŠ¨æ„å›¾
    action_intent = self.parse_thought(thought)
    # ä¾‹å¦‚ï¼š{"action": "use_tool", "tool": "search_tool", "params": {...}}
    
    if action_intent["action"] == "use_tool":
        # æ£€æŸ¥æ˜¯å¦æ˜¯è®¡åˆ’ä¸­çš„æ­¥éª¤
        current_step_id = context["current_step"]
        if current_step_id:
            planned_step = self.get_step_by_id(context["plan"], current_step_id)
            
            # éªŒè¯ï¼šLLMé€‰æ‹©çš„å·¥å…·æ˜¯å¦ä¸è®¡åˆ’ä¸€è‡´ï¼Ÿ
            if action_intent["tool"] != planned_step["tool"]:
                # ä¸ä¸€è‡´ï¼å¯èƒ½æ˜¯ï¼š
                # 1. è®¡åˆ’æœ‰è¯¯ï¼Œéœ€è¦è°ƒæ•´
                # 2. LLMå‘ç°äº†æ›´å¥½çš„æ–¹æ¡ˆ
                log.warning(f"å·¥å…·é€‰æ‹©ä¸è®¡åˆ’ä¸ä¸€è‡´: è®¡åˆ’={planned_step['tool']}, é€‰æ‹©={action_intent['tool']}")
                # è®©LLMè‡ªå·±å†³å®šæ˜¯å¦ç»§ç»­
                return self.confirm_action_with_llm(thought, action_intent, planned_step)
        
        # æ‰§è¡Œå·¥å…·è°ƒç”¨
        return {
            "type": "tool_call",
            "tool": action_intent["tool"],
            "params": action_intent["params"]
        }
    
    elif action_intent["action"] == "adjust_plan":
        # è§¦å‘è®¡åˆ’è°ƒæ•´
        return {"type": "adjust_plan", "reason": action_intent["reason"]}
    
    elif action_intent["action"] == "final_answer":
        return {"type": "final_answer", "content": action_intent["content"]}
    
    else:
        return {"type": "continue", "content": "ç»§ç»­æ¨ç†"}
```

---

### **ç¬¬5æ­¥ï¼šOBSERVEé˜¶æ®µï¼ˆæ‰§è¡Œå¹¶è®°å½•ç»“æœï¼‰**

```python
def execute_action(self, action):
    if action["type"] == "tool_call":
        tool_name = action["tool"]
        params = action["params"]
        
        # è°ƒç”¨å·¥å…·
        try:
            result = self.tool_executor.execute(tool_name, params)
            observation = f"âœ… å·¥å…· {tool_name} æ‰§è¡ŒæˆåŠŸ:\n{result}"
            
            # æ ‡è®°æ­¥éª¤å®Œæˆ
            if self.context["current_step"]:
                self.context["completed_steps"].append(self.context["current_step"])
                self.context["current_step"] = None  # é‡ç½®ï¼Œç­‰å¾…ä¸‹ä¸€æ­¥æ¨ç†
            
            return observation
            
        except Exception as e:
            return f"âŒ å·¥å…· {tool_name} æ‰§è¡Œå¤±è´¥: {str(e)}"
    
    elif action["type"] == "adjust_plan":
        # è®¡åˆ’è°ƒæ•´ç”±ç›‘æ§å±‚å¤„ç†ï¼Œè¿™é‡Œåªè®°å½•
        return f"ğŸ”„ è®¡åˆ’è°ƒæ•´ä¸­: {action['reason']}"
    
    elif action["type"] == "final_answer":
        return f"ğŸ¯ ä»»åŠ¡å®Œæˆ: {action['content']}"
```

---

## ğŸ” åŠ¨æ€è°ƒæ•´è®¡åˆ’æœºåˆ¶

### **ç›‘æ§è§¦å‘æ¡ä»¶**

```python
def should_adjust_plan(self, observation, context):
    """
    åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒæ•´è®¡åˆ’
    """
    
    # æ¡ä»¶1ï¼šå·¥å…·æ‰§è¡Œå¤±è´¥
    if "âŒ" in observation and "æ‰§è¡Œå¤±è´¥" in observation:
        return True, "å·¥å…·æ‰§è¡Œå¤±è´¥ï¼Œéœ€è¦é‡æ–°è§„åˆ’"
    
    # æ¡ä»¶2ï¼šè¿ç»­å¤±è´¥æ¬¡æ•°è¿‡å¤š
    if self.count_recent_failures(context["history"]) >= 3:
        return True, "è¿ç»­å¤±è´¥ï¼Œéœ€è¦é‡æ–°è§„åˆ’"
    
    # æ¡ä»¶3ï¼šæ£€æµ‹åˆ°å¾ªç¯/é‡å¤è¡Œä¸º
    if self.detect_loop(context["history"]):
        return True, "æ£€æµ‹åˆ°é‡å¤æ¨ç†ï¼Œéœ€è¦é‡æ–°è§„åˆ’"
    
    # æ¡ä»¶4ï¼šç»“æœä¸ç¬¦åˆé¢„æœŸï¼ˆé€šè¿‡LLMåˆ¤æ–­ï¼‰
    if self.is_result_unexpected(observation, context):
        return True, "ç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œéœ€è¦è°ƒæ•´è®¡åˆ’"
    
    # æ¡ä»¶5ï¼šç”¨æˆ·ä¸»åŠ¨è¦æ±‚è°ƒæ•´
    if "é‡æ–°è§„åˆ’" in observation or "è°ƒæ•´è®¡åˆ’" in observation:
        return True, "ç”¨æˆ·è¦æ±‚é‡æ–°è§„åˆ’"
    
    return False, None
```

### **è®¡åˆ’è°ƒæ•´æ‰§è¡Œ**

```python
def adjust_plan(self, context):
    """
    é‡æ–°ç”Ÿæˆæˆ–ä¿®è®¢è®¡åˆ’
    """
    
    adjust_reason = context.get("adjust_reason", "è‡ªåŠ¨è°ƒæ•´")
    
    # æ„é€ ä¿®è®¢è®¡åˆ’çš„æç¤º
    revision_prompt = f"""
ã€åŸå§‹è®¡åˆ’ã€‘
{json.dumps(context['plan'], indent=2, ensure_ascii=False)}

ã€å·²å®Œæˆæ­¥éª¤ã€‘
{context['completed_steps']}

ã€é‡åˆ°çš„é—®é¢˜ã€‘
{adjust_reason}

ã€æ‰§è¡Œå†å²ã€‘
{self.format_history(context['history'][-10:])}

ã€è¯·é‡æ–°è§„åˆ’ã€‘
1. åˆ†æåŸè®¡åˆ’çš„é—®é¢˜
2. ç”Ÿæˆæ–°çš„æ‰§è¡Œæ­¥éª¤
3. è€ƒè™‘å·²å®Œæˆçš„å·¥ä½œï¼Œé¿å…é‡å¤

ã€è¾“å‡ºæ ¼å¼ã€‘
PLAN: [æ–°çš„JSONè®¡åˆ’]
"""
    
    # è°ƒç”¨è§„åˆ’å™¨ç”Ÿæˆæ–°è®¡åˆ’
    new_plan_json = self.planner.revise_plan(revision_prompt)
    
    # æ›´æ–°ä¸Šä¸‹æ–‡ä¸­çš„è®¡åˆ’
    context["plan"] = new_plan_json
    context["current_step"] = None  # é‡ç½®å½“å‰æ­¥éª¤ï¼Œé‡æ–°æ¨ç†
    
    log.info(f"âœ… è®¡åˆ’å·²è°ƒæ•´: {adjust_reason}")
    log.debug(f"æ–°è®¡åˆ’: {json.dumps(new_plan_json, indent=2, ensure_ascii=False)}")
```

---

## ğŸ“‹ å®Œæ•´æ‰§è¡Œç¤ºä¾‹

### **åœºæ™¯ï¼šç”ŸæˆAPIç¤ºä¾‹ä»£ç å¹¶æµ‹è¯•**

```
ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªPythonçš„requestsåº“GETè¯·æ±‚ç¤ºä¾‹ï¼Œå¹¶æµ‹è¯•èƒ½å¦è®¿é—®ç™¾åº¦"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤1: å¤æ‚åº¦åˆ¤æ–­ â†’ å¤æ‚ä»»åŠ¡ â†’ ç”ŸæˆPlan                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Planç”Ÿæˆ:
{
  "steps": [
    {"id": "step_1", "name": "æœç´¢requestsåº“æ–‡æ¡£", "tool": "search_tool"},
    {"id": "step_2", "name": "ç”ŸæˆGETè¯·æ±‚ç¤ºä¾‹ä»£ç ", "tool": "code_tool"},
    {"id": "step_3", "name": "è¿è¡Œæµ‹è¯•", "tool": "execute_tool"},
    {"id": "step_4", "name": "éªŒè¯ç»“æœ", "tool": "verify_tool"}
  ]
}

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤2: ReAct Loopæ‰§è¡Œï¼ˆç»Ÿä¸€å¼•æ“ï¼‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Iteration 1
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€THOUGHTã€‘
ã€å½“å‰è®¡åˆ’ã€‘
æ€»æ­¥éª¤æ•°ï¼š4
å·²å®Œæˆï¼š0/4

æ­¥éª¤è¯¦æƒ…ï¼š
- æœç´¢requestsåº“æ–‡æ¡£ (step_1) [ğŸ¯ æ­£åœ¨æ‰§è¡Œ]
- ç”ŸæˆGETè¯·æ±‚ç¤ºä¾‹ä»£ç  (step_2) [â³ å¾…æ‰§è¡Œ]
- è¿è¡Œæµ‹è¯• (step_3) [â³ å¾…æ‰§è¡Œ]
- éªŒè¯ç»“æœ (step_4) [â³ å¾…æ‰§è¡Œ]

ã€ç”¨æˆ·éœ€æ±‚ã€‘
ç”ŸæˆPython requestsåº“GETè¯·æ±‚ç¤ºä¾‹å¹¶æµ‹è¯•

ã€è¯·æ€è€ƒã€‘
1. å½“å‰åº”è¯¥æ‰§è¡Œstep_1ï¼šæœç´¢requestsåº“æ–‡æ¡£
2. éœ€è¦è°ƒç”¨search_tool
3. æš‚æ— å¼‚å¸¸

THOUGHT: æˆ‘éœ€è¦å…ˆæœç´¢requestsåº“çš„å®˜æ–¹æ–‡æ¡£ï¼Œäº†è§£GETè¯·æ±‚çš„æ­£ç¡®ç”¨æ³•ã€‚

ã€ACTIONã€‘
TOOL_CALL: search_tool
PARAMS: {"query": "python requests library GET request example"}

ã€OBSERVATIONã€‘
âœ… å·¥å…· search_tool æ‰§è¡ŒæˆåŠŸ:
æ‰¾åˆ°äº†requestså®˜æ–¹æ–‡æ¡£ï¼š
import requests
response = requests.get('https://www.example.com')
print(response.status_code)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Iteration 2
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€THOUGHTã€‘
ã€å½“å‰è®¡åˆ’ã€‘
æ€»æ­¥éª¤æ•°ï¼š4
å·²å®Œæˆï¼š1/4 (step_1)

æ­¥éª¤è¯¦æƒ…ï¼š
- æœç´¢requestsåº“æ–‡æ¡£ (step_1) [âœ… å·²å®Œæˆ]
- ç”ŸæˆGETè¯·æ±‚ç¤ºä¾‹ä»£ç  (step_2) [ğŸ¯ æ­£åœ¨æ‰§è¡Œ]
- è¿è¡Œæµ‹è¯• (step_3) [â³ å¾…æ‰§è¡Œ]
- éªŒè¯ç»“æœ (step_4) [â³ å¾…æ‰§è¡Œ]

ã€æ‰§è¡Œå†å²ã€‘
ä¸Šä¸€æ­¥ï¼šæˆåŠŸè·å–requestsæ–‡æ¡£

ã€è¯·æ€è€ƒã€‘
1. step_1å·²å®Œæˆï¼Œç°åœ¨æ‰§è¡Œstep_2
2. éœ€è¦è°ƒç”¨code_toolç”Ÿæˆä»£ç 
3. ä½¿ç”¨ç™¾åº¦ä½œä¸ºæµ‹è¯•ç›®æ ‡

THOUGHT: æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘å°†ç”Ÿæˆä¸€ä¸ªè®¿é—®ç™¾åº¦çš„GETè¯·æ±‚ç¤ºä¾‹ä»£ç ã€‚

ã€ACTIONã€‘
TOOL_CALL: code_tool
PARAMS: {
  "language": "python",
  "task": "ç”Ÿæˆrequests GETè¯·æ±‚ç¤ºä¾‹ï¼Œè®¿é—®ç™¾åº¦",
  "template": "import requests\nresponse = requests.get('https://www.baidu.com')\nprint(response.status_code)"
}

ã€OBSERVATIONã€‘
âœ… å·¥å…· code_tool æ‰§è¡ŒæˆåŠŸ:
ç”Ÿæˆä»£ç ï¼š
```python
import requests
response = requests.get('https://www.baidu.com')
print(f"çŠ¶æ€ç : {response.status_code}")
print(f"å“åº”å†…å®¹é•¿åº¦: {len(response.text)}")
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Iteration 3
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€THOUGHTã€‘
ã€å½“å‰è®¡åˆ’ã€‘
æ€»æ­¥éª¤æ•°ï¼š4
å·²å®Œæˆï¼š2/4 (step_1, step_2)

æ­¥éª¤è¯¦æƒ…ï¼š
- æœç´¢requestsåº“æ–‡æ¡£ (step_1) [âœ… å·²å®Œæˆ]
- ç”ŸæˆGETè¯·æ±‚ç¤ºä¾‹ä»£ç  (step_2) [âœ… å·²å®Œæˆ]
- è¿è¡Œæµ‹è¯• (step_3) [ğŸ¯ æ­£åœ¨æ‰§è¡Œ]
- éªŒè¯ç»“æœ (step_4) [â³ å¾…æ‰§è¡Œ]

ã€è¯·æ€è€ƒã€‘
1. æ‰§è¡Œstep_3ï¼šè¿è¡Œç”Ÿæˆçš„ä»£ç 
2. è°ƒç”¨execute_tool

THOUGHT: ç°åœ¨è¿è¡Œç”Ÿæˆçš„ä»£ç ï¼Œæµ‹è¯•èƒ½å¦æˆåŠŸè®¿é—®ç™¾åº¦ã€‚

ã€ACTIONã€‘
TOOL_CALL: execute_tool
PARAMS: {"code": "import requests\nresponse = requests.get('https://www.baidu.com')\nprint(f'çŠ¶æ€ç : {response.status_code}')\nprint(f'å“åº”å†…å®¹é•¿åº¦: {len(response.text)}')"}

ã€OBSERVATIONã€‘
âœ… å·¥å…· execute_tool æ‰§è¡ŒæˆåŠŸ:
è¾“å‡ºï¼š
çŠ¶æ€ç : 200
å“åº”å†…å®¹é•¿åº¦: 244183

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Iteration 4
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€THOUGHTã€‘
ã€å½“å‰è®¡åˆ’ã€‘
æ€»æ­¥éª¤æ•°ï¼š4
å·²å®Œæˆï¼š3/4 (step_1, step_2, step_3)

æ­¥éª¤è¯¦æƒ…ï¼š
- æœç´¢requestsåº“æ–‡æ¡£ (step_1) [âœ… å·²å®Œæˆ]
- ç”ŸæˆGETè¯·æ±‚ç¤ºä¾‹ä»£ç  (step_2) [âœ… å·²å®Œæˆ]
- è¿è¡Œæµ‹è¯• (step_3) [âœ… å·²å®Œæˆ]
- éªŒè¯ç»“æœ (step_4) [ğŸ¯ æ­£åœ¨æ‰§è¡Œ]

ã€è¯·æ€è€ƒã€‘
1. æ‰€æœ‰æ­¥éª¤å·²å®Œæˆ
2. çŠ¶æ€ç 200è¡¨ç¤ºæˆåŠŸ
3. å¯ä»¥ç»™å‡ºæœ€ç»ˆç­”æ¡ˆ

THOUGHT: æµ‹è¯•æˆåŠŸï¼çŠ¶æ€ç 200è¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œç°åœ¨å¯ä»¥ç»™å‡ºæœ€ç»ˆç­”æ¡ˆã€‚

ã€ACTIONã€‘
FINAL_ANSWER: æˆåŠŸç”Ÿæˆå¹¶æµ‹è¯•äº†requestsåº“çš„GETè¯·æ±‚ç¤ºä¾‹ï¼
ä»£ç å·²æˆåŠŸè®¿é—®ç™¾åº¦ï¼Œè¿”å›çŠ¶æ€ç 200ï¼Œå“åº”å†…å®¹é•¿åº¦244183å­—èŠ‚ã€‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… ä»»åŠ¡å®Œæˆï¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”„ åŠ¨æ€è°ƒæ•´ç¤ºä¾‹ï¼ˆPlanå‡ºé”™æ—¶ï¼‰

```
å‡è®¾åœ¨Iteration 3æ—¶ï¼Œexecute_toolå¤±è´¥ï¼š

ã€OBSERVATIONã€‘
âŒ å·¥å…· execute_tool æ‰§è¡Œå¤±è´¥: ç½‘ç»œè¶…æ—¶

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Iteration 4ï¼ˆç›‘æ§è§¦å‘è°ƒæ•´ï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€THOUGHTã€‘
ã€å½“å‰è®¡åˆ’ã€‘
æ€»æ­¥éª¤æ•°ï¼š4
å·²å®Œæˆï¼š2/4 (step_1, step_2)
å½“å‰æ­¥éª¤ï¼šstep_3ï¼ˆè¿è¡Œæµ‹è¯•ï¼‰å¤±è´¥

ã€é—®é¢˜ã€‘
ç½‘ç»œè¶…æ—¶ï¼Œæ— æ³•è®¿é—®ç™¾åº¦

ã€è¯·æ€è€ƒã€‘
1. åŸè®¡åˆ’ä¾èµ–å¤–éƒ¨ç½‘ç»œï¼Œå¯èƒ½ä¸ç¨³å®š
2. å¯ä»¥æ”¹ç”¨mockæµ‹è¯•æˆ–æœ¬åœ°æµ‹è¯•
3. éœ€è¦è°ƒæ•´è®¡åˆ’

THOUGHT: ç”±äºç½‘ç»œé—®é¢˜æ— æ³•è®¿é—®ç™¾åº¦ï¼Œæˆ‘å°†è°ƒæ•´è®¡åˆ’ï¼š
- æ”¹ç”¨httpbin.orgï¼ˆæ›´ç¨³å®šçš„æµ‹è¯•APIï¼‰
- æˆ–è€…ä½¿ç”¨mockæ–¹å¼æ¼”ç¤ºä»£ç é€»è¾‘

ã€ACTIONã€‘
ADJUST_PLAN: ç½‘ç»œè¶…æ—¶ï¼Œæ”¹ç”¨æ›´ç¨³å®šçš„æµ‹è¯•ç›®æ ‡

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
è®¡åˆ’è°ƒæ•´åçš„æ–°Plan:
{
  "steps": [
    {"id": "step_1", "name": "æœç´¢requestsåº“æ–‡æ¡£", "tool": "search_tool"},
    {"id": "step_2", "name": "ç”ŸæˆGETè¯·æ±‚ç¤ºä¾‹ä»£ç ", "tool": "code_tool"},
    {"id": "step_3_new", "name": "ä¿®æ”¹ä»£ç ï¼Œä½¿ç”¨httpbin.org", "tool": "code_tool"},
    {"id": "step_4_new", "name": "è¿è¡Œæµ‹è¯•", "tool": "execute_tool"},
    {"id": "step_5_new", "name": "éªŒè¯ç»“æœ", "tool": "verify_tool"}
  ]
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Iteration 5ï¼ˆç»§ç»­æ‰§è¡Œï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€THOUGHTã€‘
ã€å½“å‰è®¡åˆ’ã€‘ï¼ˆå·²è°ƒæ•´ï¼‰
æ€»æ­¥éª¤æ•°ï¼š5
å·²å®Œæˆï¼š2/5 (step_1, step_2)
å½“å‰æ­¥éª¤ï¼šstep_3_newï¼ˆä¿®æ”¹ä»£ç ï¼‰

...

âœ… æœ€ç»ˆæˆåŠŸå®Œæˆä»»åŠ¡ï¼
```

---

## ğŸ“Š æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“

| ç‰¹æ€§ | å®ç°æ–¹å¼ | ä¼˜åŠ¿ |
|------|----------|------|
| **ç»Ÿä¸€æ‰§è¡Œå¼•æ“** | å…¨ç¨‹åªæœ‰ä¸€ä¸ªReAct Loop | ä»£ç ç®€æ´ï¼Œç»´æŠ¤æˆæœ¬ä½ |
| **ä¸Šä¸‹æ–‡è¿è´¯** | Planä½œä¸ºä¸Šä¸‹æ–‡æ³¨å…¥æ¯æ¬¡Thought | LLMèƒ½çœ‹åˆ°å…¨å±€çŠ¶æ€ |
| **åŠ¨æ€è°ƒæ•´** | ç›‘æ§å±‚æ£€æµ‹å¼‚å¸¸ â†’ è§¦å‘Planä¿®è®¢ | è‡ªé€‚åº”å¤æ‚åœºæ™¯ |
| **ä¸ç ´åReAct** | æ‰€æœ‰æ­¥éª¤ä»èµ°Thought-Action-Observe | ä¿ç•™æ¨ç†èƒ½åŠ› |
| **äººç±»å¯è¯»** | Planç”¨è‡ªç„¶è¯­è¨€/JSONæè¿° | æ˜“äºè°ƒè¯•å’Œç†è§£ |

---

## ğŸ’¡ å…³é”®å®ç°è¦ç‚¹

1. **Planåªæ˜¯æç¤ºï¼Œä¸æ˜¯ç¡¬çº¦æŸ**ï¼šLLMå¯ä»¥è´¨ç–‘å’Œè°ƒæ•´è®¡åˆ’
2. **ä¸Šä¸‹æ–‡ç®¡ç†**ï¼šæ¯æ¬¡è¿­ä»£ä¿ç•™å®Œæ•´å†å²ï¼Œé¿å…ä¿¡æ¯ä¸¢å¤±
3. **ç›‘æ§è§¦å‘å™¨**ï¼šå¤šæ¡ä»¶åˆ¤æ–­ï¼ˆå¤±è´¥æ¬¡æ•°ã€å¾ªç¯æ£€æµ‹ã€ç»“æœå¼‚å¸¸ï¼‰
4. **æ¸è¿›å¼è°ƒæ•´**ï¼šä¼˜å…ˆå±€éƒ¨è°ƒæ•´ï¼Œå¿…è¦æ—¶æ‰å…¨é‡é‡è§„åˆ’
5. **çŠ¶æ€åŒæ­¥**ï¼šPlanæ›´æ–°åï¼ŒReAct Loopè‡ªåŠ¨æ„ŸçŸ¥å¹¶ç»§ç»­æ‰§è¡Œ

è¿™å°±æ˜¯**æ–¹æ¡ˆ3çš„ç²¾é«“**ï¼šç”¨ReAct Loopçš„"æ™ºèƒ½"æ¥æ‰§è¡ŒPlançš„"ç»“æ„"ï¼Œæ—¢ä¿æŒçµæ´»æ€§ï¼Œåˆå…·å¤‡ç³»ç»Ÿæ€§ï¼