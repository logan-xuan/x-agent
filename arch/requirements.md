# éœ€æ±‚æ”¹è¿›åˆ—è¡¨
1ã€å¼€å‘è€…æ¨¡å¼ï¼šå…¨é¢ä¸‹æ‰å‹ç¼©æµ‹è¯•tabå’Œç›¸å…³èƒ½åŠ›ï¼Œæ–°å¢å‹ç¼©è®°å½•æŸ¥è¯¢ï¼Œåœ¨æ­¤tabä¸Šèƒ½çœ‹åˆ°æ¯æ¬¡å‹ç¼©çš„è®°å½•ï¼ŒåŒ…å«åŸå§‹çš„sessionIDå¯¹è¯çš„å…¨éƒ¨è®°å½•å’Œå‹ç¼©åè¯·æ±‚å’Œå“åº”çš„æ•°æ®ã€‚
2ã€å¼€å‘è€…æ¨¡å¼->trace. Trace Vieweræ”¹é€ ï¼ŒHigh Level éœ€è¦é‡ç‚¹å±•ç¤ºä¸€æ¬¡è¯·æ±‚è¿‡ç¨‹ä¸­é‡è¦ç»“ç‚¹æˆ–ç»„ä»¶æ‰§è¡Œé¡ºåºå’Œå‚æ•°å“åº”ï¼Œflowcanvasä¸Šéœ€è¦åæ˜ LLMè°ƒç”¨ã€toolsè°ƒç”¨ã€commondã€skillsè°ƒç”¨ã€è®°å¿†å­˜å‚¨å’ŒæŸ¥è¯¢ï¼Œé¼ æ ‡ç‚¹å‡»å…¶ä¸­çš„ç»“ç‚¹æ—¶ï¼Œèƒ½æŸ¥çœ‹åˆ°å…·ä½“çš„å…¥å‚å’Œå‡ºå‚ï¼Œè¯·æ±‚å’Œå“åº”æ—¶é—´ç­‰å…³é”®æ•°æ®ã€‚
3ã€å¼€å‘è€…æ¨¡å¼->trace->Analysis,ä¸ºä»€ä¹ˆå‡å°‘è¯·æ±‚æ¬¡æ•°ï¼Œä»¥markdonwæ–‡ä»¶å­˜å‚¨æ¯æ¬¡çš„åˆ†æç»“æœï¼Œå­˜æ”¾dev/Analysis ä¸“å±ç›®å½•ä¸‹ï¼Œä¸‹æ¬¡é€štraceIdæŸ¥è¯¢æ—¶ï¼Œå¦‚æœå­˜åœ¨Analysisåˆ†ææ–‡ä»¶ç›´æ¥è¯»å–å³å¯ï¼Œç”¨æˆ·ä¹Ÿå¯é‡æ–°åˆ†æç”Ÿæˆï¼ŒåŠ è½½æœ€æ–°çš„Analysisæ–‡ä»¶ã€‚
3ã€å¼€å‘è€…æ¨¡å¼ï¼šæœç´¢è°ƒè¯•ã€‚æ–°å¢è®°å¿†é‡ç½®æŒ‰é’®ï¼Œå°†å‘é‡å’Œé•¿æœŸè®°å¿†å’ŒçŸ­æœŸè®°å¿†markdownæ–‡ä»¶å…¨éƒ¨æ¸…ç©ºã€‚æ–°å¢è®°å¿†å‘é‡åŒæ­¥æŒ‰é’®ï¼Œå…ˆæ¸…ç©ºå‘é‡æ•°æ®åº“çš„æ‰€æœ‰è®°å¿†æ•°æ®ï¼Œå†å°†markdownæ–‡ä»¶çš„è®°å¿†æ•°æ®å…¨éƒ¨åŒæ­¥åˆ°å‘é‡æ•°æ®åº“ï¼Œä»è€Œä¿æŒmarkdownå’Œå‘é‡æ•°æ®çš„ä¸€è‡´ã€‚

4ã€å‰©ä½™çš„å­ç›®å½•å‘ç°å’ŒåŠ¨æ€ä¸Šä¸‹æ–‡æ˜¯é”¦ä¸Šæ·»èŠ±çš„åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‹©æœºå®æ–½ï¼ğŸš€
 å­ç›®å½•è‡ªåŠ¨å‘ç° ğŸŸ¢ ä½ä¼˜å…ˆçº§
é¢„è®¡æ—¶é—´: 1 å°æ—¶
çŠ¶æ€: æœªå®æ–½
 åŠ¨æ€ä¸Šä¸‹æ–‡æ³¨å…¥ (!`command) ğŸŸ¢ ä½ä¼˜å…ˆçº§

5ã€åŠ å›ºwebsocketè¿æ¥


é¢„é˜²æªæ–½å»ºè®®
1. å¢åŠ  WebSocket å¿ƒè·³æ£€æµ‹
python
# å‰ç«¯ï¼šå®šæœŸå‘é€ ping
setInterval(() => {
  ws.send(JSON.stringify({ type: 'ping' }));
}, 30000);  // æ¯30ç§’

# åç«¯ï¼šæ£€æµ‹è¶…æ—¶
async def check_connection_alive(websocket):
    while True:
        await asyncio.sleep(30)
        try:
            await websocket.send_json({"type": "ping"})
        except:
            break  # è¿æ¥å·²æ–­å¼€
2. ä»»åŠ¡æŒä¹…åŒ–
python
# å°†ä»»åŠ¡çŠ¶æ€ä¿å­˜åˆ°æ•°æ®åº“
class TaskState:
    task_id: str
    current_step: int
    total_steps: int
    script_path: str
    status: str  # pending, running, completed, interrupted
3. æ–­çº¿é‡è¿æ¢å¤
javascript
// å‰ç«¯ï¼šè‡ªåŠ¨é‡è¿
ws.onclose = (event) => {
  setTimeout(() => {
    reconnect(session_id, last_task_id);
  }, 3000);
};
4. ä»»åŠ¡å®Œæˆç¡®è®¤
python
# åç«¯ï¼šç¡®ä¿æ‰€æœ‰æ­¥éª¤å®Œæˆåå†ç»“æŸ
async def execute_with_confirmation(task):
    for step in task.steps:
        await execute_step(step)
        await confirm_step_completed(step.id)
    
    # æ‰€æœ‰æ­¥éª¤å®Œæˆåæ‰è¿”å›æœ€ç»ˆç»“æœ
    return final_result
æ€»ç»“ï¼šè¿™ä¸æ˜¯ç³»ç»Ÿé€»è¾‘é—®é¢˜ï¼Œè€Œæ˜¯ WebSocket è¿æ¥ç¨³å®šæ€§é—®é¢˜ã€‚å»ºè®®å¢å¼ºè¿æ¥ç¨³å®šæ€§ã€ä»»åŠ¡æŒä¹…åŒ–å’Œæ–­çº¿é‡è¿æœºåˆ¶