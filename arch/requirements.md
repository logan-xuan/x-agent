# éœ€æ±‚æ”¹è¿›åˆ—è¡¨
1ã€å¼€å‘è€…æ¨¡å¼ï¼šå…¨é¢ä¸‹æ‰å‹ç¼©æµ‹è¯•tabå’Œç›¸å…³èƒ½åŠ›ï¼Œæ–°å¢å‹ç¼©è®°å½•æŸ¥è¯¢ï¼Œåœ¨æ­¤tabä¸Šèƒ½çœ‹åˆ°æ¯æ¬¡å‹ç¼©çš„è®°å½•ï¼ŒåŒ…å«åŸå§‹çš„sessionIDå¯¹è¯çš„å…¨éƒ¨è®°å½•å’Œå‹ç¼©åè¯·æ±‚å’Œå“åº”çš„æ•°æ®ã€‚
2ã€å¼€å‘è€…æ¨¡å¼->trace. Trace Vieweræ”¹é€ ï¼Œé€šè¿‡traceIdï¼Œæˆ‘éœ€è¦çœ‹åˆ°ä¸€æ¬¡è¯·æ±‚è¿‡ç¨‹ä¸­é‡è¦ç»“ç‚¹æˆ–ç»„ä»¶æ‰§è¡Œé¡ºåºå’Œå‚æ•°å“åº”ï¼Œflowcanvasä¸Šéœ€è¦åæ˜ LLMè°ƒç”¨ã€toolsè°ƒç”¨ã€commondã€skillsè°ƒç”¨ã€è®°å¿†å­˜å‚¨å’ŒæŸ¥è¯¢ï¼Œé¼ æ ‡ç‚¹å‡»å…¶ä¸­çš„ç»“ç‚¹æ—¶ï¼Œèƒ½æŸ¥çœ‹åˆ°å…·ä½“çš„å…¥å‚å’Œå‡ºå‚ï¼Œè¯·æ±‚å’Œå“åº”æ—¶é—´ç­‰å…³é”®æ•°æ®ã€‚éœ€è¦çœ‹æ¸…æ¥šçš„æ‰§è¡Œçš„æ—¶åºå’Œå‚æ•°ä»¥ä¾¿ä¼˜åŒ–å’Œç®€å•ï¼Œæ¸…æ¥šçš„æŒæ¡ReAct Loop ,Plan Mode,skills ,tools,æ¯ä¸€æ¬¡çš„promptæ•°æ®å’Œå“åº”ï¼Œä»–ä»¬çš„è°ƒç”¨å…³ç³»ï¼Œè°ƒç”¨é¡ºåºï¼Œè°ƒç”¨è€—æ—¶ã€‚æ ¹æ®æˆ‘çš„éœ€æ±‚ä½ å¯ä»¥å…ˆåšä¸€ä»½è¯¦ç»†çš„æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ—¥å¿—çš„å˜æ›´å’Œè¿½åŠ ã€‚
3ã€fetch_content è·å–ç½‘é¡µå†…å®¹æ•°æ®


4ã€å‰©ä½™çš„å­ç›®å½•å‘ç°å’ŒåŠ¨æ€ä¸Šä¸‹æ–‡æ˜¯é”¦ä¸Šæ·»èŠ±çš„åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‹©æœºå®æ–½ï¼ğŸš€
 å­ç›®å½•è‡ªåŠ¨å‘ç° ğŸŸ¢ ä½ä¼˜å…ˆçº§
é¢„è®¡æ—¶é—´: 1 å°æ—¶
çŠ¶æ€: æœªå®æ–½
 åŠ¨æ€ä¸Šä¸‹æ–‡æ³¨å…¥ (!`command) ğŸŸ¢ ä½ä¼˜å…ˆçº§

5ã€åŠ å›ºwebsocketè¿æ¥


é¢„é˜²æªæ–½å»ºè®®
1. å¢åŠ  WebSocket å¿ƒè·³æ£€æµ‹
python
# å‰ç«¯ï¼šå®šæœŸå‘é€ ping
setInterval(() => {
  ws.send(JSON.stringify({ type: 'ping' }));
}, 30000);  // æ¯30ç§’

# åç«¯ï¼šæ£€æµ‹è¶…æ—¶
async def check_connection_alive(websocket):
    while True:
        await asyncio.sleep(30)
        try:
            await websocket.send_json({"type": "ping"})
        except:
            break  # è¿æ¥å·²æ–­å¼€
2. ä»»åŠ¡æŒä¹…åŒ–
python
# å°†ä»»åŠ¡çŠ¶æ€ä¿å­˜åˆ°æ•°æ®åº“
class TaskState:
    task_id: str
    current_step: int
    total_steps: int
    script_path: str
    status: str  # pending, running, completed, interrupted
3. æ–­çº¿é‡è¿æ¢å¤
javascript
// å‰ç«¯ï¼šè‡ªåŠ¨é‡è¿
ws.onclose = (event) => {
  setTimeout(() => {
    reconnect(session_id, last_task_id);
  }, 3000);
};
4. ä»»åŠ¡å®Œæˆç¡®è®¤
python
# åç«¯ï¼šç¡®ä¿æ‰€æœ‰æ­¥éª¤å®Œæˆåå†ç»“æŸ
async def execute_with_confirmation(task):
    for step in task.steps:
        await execute_step(step)
        await confirm_step_completed(step.id)
    
    # æ‰€æœ‰æ­¥éª¤å®Œæˆåæ‰è¿”å›æœ€ç»ˆç»“æœ
    return final_result
æ€»ç»“ï¼šè¿™ä¸æ˜¯ç³»ç»Ÿé€»è¾‘é—®é¢˜ï¼Œè€Œæ˜¯ WebSocket è¿æ¥ç¨³å®šæ€§é—®é¢˜ã€‚å»ºè®®å¢å¼ºè¿æ¥ç¨³å®šæ€§ã€ä»»åŠ¡æŒä¹…åŒ–å’Œæ–­çº¿é‡è¿æœºåˆ¶